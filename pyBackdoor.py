#!/bin/python3

from operator import truediv
import socket, platform, os

print("Socket Info")
SERVER_ADDRESS = input("  Server IP: ")
SERVER_PORT    = input("Server Port: ")

usedSocket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
usedSocket.setsockopt((socket.SOL_SOCKET, socket.SO_REUSEADDR, 1))
usedSocket.bind((SERVER_ADDRESS, SERVER_PORT))
usedSocket.listen(1)

connection, address = usedSocket.accept()

print("\nConnection Status: %" + usedSocket)

while True:
    try:
        data = connection.recv(1024)
    except:continue

    if(data.decode('utf-8') == '1'):
        tosend = platform.platform() + " " + platform.machine()
        connection.sendall(tosend.encode())
    elif(data.decode('utf-8') == '2'):
        data = connection.recv(1024)
        try:
            filelist = os.listdir(data.decode('utf-8'))
            tosend = ""

            for file in filelist:
                tosend += "," + file
        except:
            tosend = "Wrong Path"
        connection.sendall(tosend.encode())
    elif(data.decode('utf-8') == '0'):
        connection.close()
        connection, address = usedSocket.accept()
    print("Socket Closed")