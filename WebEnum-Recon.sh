#!/bin/bash

url=$1

# Creates file of url passed in
if [ ! -d "$url" ];then
    mkdir $url
fi
# Creates Recon file
if [ ! -d "$url/recon" ];then
    mkdir $url/recon
fi

# Install Assetfinder - go get -u github.com/tomnomnom/assetfinder
echo "[+] Harvesting subdomains with assetfinder..."
assetfinder $url >> $url/recon/assets.txt
# Remove Duplicates
cat $url/recon/assets.txt | grep $1 >> $url/recon/final.txt
rm $url/recon/assets.txt # Remove .txt with dupes


# Install Amass - go get -v github.com/OWASP/Amass/cmd/amass
#echo "[+] Harvesting subdomains with Amass..."
#amass enum -d $url >> $url/recon/f.txt

#sort -u $url/recon/f.txt >> $url/recon/final.txt
#rm $url/recon/f.txt

# Install httprobe - go get -u github.com/tomnomnom/httprobe
echo "[+] Probing for Alive Domains with httprobe..."
cat tesla.com/recon/final.txt | sort -u | httprobe -s -p https:443 | sed 's/https\?:\/\///' | tr -d ':443' >> $url/recon/alive.txt